'use client'

import { ExternalLink } from 'lucide-react'

// Steam Logo
export function SteamIcon({ className }: { className?: string }) {
  return (
    <svg className={className} viewBox="0 0 24 24" fill="currentColor">
      <path d="M11.979 0C5.678 0 .511 4.86.022 11.037l6.432 2.658c.545-.371 1.203-.59 1.912-.59.063 0 .125.004.188.006l2.861-4.142V8.91c0-2.495 2.028-4.524 4.524-4.524 2.494 0 4.524 2.031 4.524 4.527s-2.03 4.525-4.524 4.525h-.105l-4.076 2.911c0 .052.004.105.004.159 0 1.875-1.515 3.396-3.39 3.396-1.635 0-3.016-1.173-3.331-2.727L.436 15.27C1.862 20.307 6.486 24 11.979 24c6.627 0 11.999-5.373 11.999-12S18.605 0 11.979 0zM7.54 18.21l-1.473-.61c.262.543.714.999 1.314 1.25 1.297.539 2.793-.076 3.332-1.375.263-.63.264-1.319.005-1.949s-.75-1.121-1.377-1.383c-.624-.26-1.29-.249-1.878-.03l1.523.63c.956.4 1.409 1.5 1.009 2.455-.397.957-1.497 1.41-2.454 1.012H7.54zm11.415-9.303c0-1.662-1.353-3.015-3.015-3.015-1.665 0-3.015 1.353-3.015 3.015 0 1.665 1.35 3.015 3.015 3.015 1.663 0 3.015-1.35 3.015-3.015zm-5.273-.005c0-1.252 1.013-2.266 2.265-2.266 1.249 0 2.266 1.014 2.266 2.266 0 1.251-1.017 2.265-2.266 2.265-1.253 0-2.265-1.014-2.265-2.265z"/>
    </svg>
  )
}

// PlayStation Logo
export function PlayStationIcon({ className }: { className?: string }) {
  return (
    <svg className={className} viewBox="0 0 24 24" fill="currentColor">
      <path d="M8.985 2.596v17.548l3.915 1.261V6.688c0-.69.304-1.151.794-.991.636.181.76.814.76 1.505v5.876c2.441 1.193 4.362-.002 4.362-3.153 0-3.237-1.126-4.675-4.438-5.827-1.307-.448-3.728-1.186-5.391-1.502h-.002zm4.656 16.242l6.296-2.275c.715-.258.826-.625.246-.818-.586-.192-1.637-.139-2.357.123l-4.205 1.5v-2.385l.24-.085s1.201-.42 2.913-.615c1.696-.18 3.785.03 5.437.661 1.848.601 2.041 1.472 1.576 2.072s-1.622 1.036-1.622 1.036l-8.544 3.107v-2.297l.02-.024zM1.348 18.18c-1.92-.494-2.235-1.521-1.362-2.152.804-.584 2.171-1.027 2.171-1.027l5.655-2.029v2.313l-4.07 1.457c-.715.254-.826.625-.246.817.587.194 1.637.14 2.358-.123l1.958-.697v2.07c-.16.027-.322.048-.49.074-1.876.27-3.866-.166-5.974-.703z"/>
    </svg>
  )
}

// Xbox Logo
export function XboxIcon({ className }: { className?: string }) {
  return (
    <svg className={className} viewBox="0 0 24 24" fill="currentColor">
      <path d="M4.102 21.033C6.211 22.881 8.977 24 12 24c3.026 0 5.789-1.119 7.902-2.967 1.877-1.912-4.316-8.709-7.902-11.417-3.582 2.708-9.779 9.505-7.898 11.417zm11.16-14.406c2.5 2.961 7.484 10.313 6.076 12.912C23.016 17.522 24 14.872 24 12c0-2.125-.564-4.123-1.537-5.871-1.611-.879-4.191.466-7.201 4.498zM8.738 6.627c-3.01-4.032-5.59-5.377-7.2-4.498C.563 3.877 0 5.875 0 8c0 2.872.984 5.522 2.662 7.539-1.408-2.599 3.576-9.951 6.076-12.912zM12 0c-1.676 0-3.27.332-4.721.949C9.012 1.717 10.47 2.939 12 4.417c1.53-1.478 2.988-2.7 4.721-3.468C15.27.332 13.676 0 12 0z"/>
    </svg>
  )
}

// Nintendo Switch Logo
export function NintendoIcon({ className }: { className?: string }) {
  return (
    <svg className={className} viewBox="0 0 24 24" fill="currentColor">
      <path d="M14.176 24h3.674c3.376 0 6.15-2.774 6.15-6.15V6.15C24 2.775 21.226 0 17.85 0H14.1c-.074 0-.15.074-.15.15v23.7c-.001.076.075.15.226.15zm4.574-13.199c1.351 0 2.399 1.124 2.399 2.398 0 1.352-1.125 2.4-2.399 2.4-1.35 0-2.4-1.048-2.4-2.4-.075-1.274 1.05-2.398 2.4-2.398zM0 17.85c0 3.376 2.774 6.15 6.15 6.15h3.674c.15 0 .226-.074.226-.15V.15c0-.076-.074-.15-.15-.15H6.15C2.774 0 0 2.775 0 6.15v11.7zm6.15-5.049c-1.35 0-2.4-1.124-2.4-2.398 0-1.352 1.125-2.4 2.4-2.4 1.351 0 2.399 1.048 2.399 2.4.076 1.274-1.048 2.398-2.399 2.398z"/>
    </svg>
  )
}

// Epic Games Logo
export function EpicIcon({ className }: { className?: string }) {
  return (
    <svg className={className} viewBox="0 0 24 24" fill="currentColor">
      <path d="M3.537 0C2.165 0 1.66.506 1.66 1.879V18.44a4.262 4.262 0 00.04.507c.096.7.392 1.418 1.032 1.967.6.514 1.23.74 1.805.86V24h.001l5.25-.001v-4.633c0-.253.168-.423.42-.423.253 0 .423.17.423.423v4.633h5.252v-4.633c0-.253.168-.423.42-.423.254 0 .422.17.422.423v4.633h5.253v-2.227c.574-.12 1.205-.345 1.805-.86.64-.548.936-1.266 1.032-1.966a4.26 4.26 0 00.04-.508V1.879C23.856.506 23.35 0 21.98 0zm.791 1.879h2.11c.252 0 .421.168.421.421v5.044c0 .253-.17.422-.422.422H4.328a.421.421 0 01-.42-.422V2.3c0-.253.168-.421.42-.421zm5.252 0h2.11c.253 0 .422.168.422.421v5.044c0 .253-.169.422-.422.422H9.58a.421.421 0 01-.421-.422V2.3c0-.253.168-.421.42-.421zm5.253 0h2.11c.252 0 .421.168.421.421v5.044c0 .253-.169.422-.422.422h-2.109a.421.421 0 01-.421-.422V2.3c0-.253.168-.421.42-.421zm5.252 0h2.11c.253 0 .422.168.422.421v5.044c0 .253-.17.422-.422.422h-2.11a.421.421 0 01-.421-.422V2.3c0-.253.168-.421.42-.421zM4.328 9.18h2.11c.252 0 .421.169.421.422v5.044c0 .253-.17.421-.422.421H4.328a.421.421 0 01-.42-.421V9.602c0-.253.168-.422.42-.422zm5.252 0h2.11c.253 0 .422.169.422.422v5.044c0 .253-.169.421-.422.421H9.58a.421.421 0 01-.421-.421V9.602c0-.253.168-.422.42-.422zm5.253 0h2.11c.252 0 .421.169.421.422v5.044c0 .253-.169.421-.422.421h-2.109a.421.421 0 01-.421-.421V9.602c0-.253.168-.422.42-.422zm5.252 0h2.11c.253 0 .422.169.422.422v5.044c0 .253-.17.421-.422.421h-2.11a.421.421 0 01-.421-.421V9.602c0-.253.168-.422.42-.422z"/>
    </svg>
  )
}

// Battle.net Logo
export function BattleNetIcon({ className }: { className?: string }) {
  return (
    <svg className={className} viewBox="0 0 24 24" fill="currentColor">
      <path d="M10.457 0c-1.024.009-2.089.17-3.16.527C3.474 1.96 1.09 5.115.332 8.268c-.355 1.47-.395 2.963-.176 4.38a9.058 9.058 0 00.496 1.812c.164.427.356.852.568 1.268.11.22.23.437.353.65-.094-.007-.186-.018-.278-.03a5.478 5.478 0 01-1.028-.242c.096.353.212.702.35 1.046.262.662.597 1.306 1.01 1.92.174.264.36.52.563.775.202.25.42.495.652.732.152.155.31.306.475.455a7.873 7.873 0 01-1.038-.05c.32.373.673.735 1.063 1.085.774.691 1.673 1.334 2.702 1.873.32.17.652.33.996.48.34.148.692.286 1.054.41.48.167.98.311 1.494.43-.306-.042-.607-.093-.899-.152a8.986 8.986 0 01-.86-.214 9.324 9.324 0 01-1.586-.61c.51.222 1.05.41 1.622.556.928.234 1.934.366 2.996.363a12.37 12.37 0 003.275-.436c.271-.076.537-.163.8-.256.524-.187 1.03-.41 1.515-.66.358-.184.698-.388 1.02-.607.263-.18.51-.372.744-.577-.055.18-.118.357-.186.53a6.476 6.476 0 01-.404.861c.41-.177.807-.387 1.186-.63.69-.437 1.34-.953 1.919-1.542.194-.196.38-.4.558-.612.179-.212.35-.432.512-.661.185-.262.358-.538.517-.82a4.37 4.37 0 01-.51.14c-.182.037-.367.063-.553.073.27-.314.519-.648.74-1.003.396-.634.72-1.326.949-2.068.187-.594.313-1.22.37-1.87.058-.644.05-1.315-.029-2.004a9.03 9.03 0 00-.155-.942.702.702 0 01.103.183c.05.12.1.246.146.376.09.258.169.539.235.837-.005-.402-.04-.807-.109-1.21a7.76 7.76 0 00-.282-1.17 6.856 6.856 0 00-.44-1.08 5.744 5.744 0 00-.59-.944 6.26 6.26 0 00-.257-.315 7.21 7.21 0 00-.283-.302c.04.101.076.203.107.306.063.214.11.43.137.644a5.48 5.48 0 00-.563-.727 5.65 5.65 0 00-.695-.656 6.127 6.127 0 00-.809-.535 6.762 6.762 0 00-.91-.41 9.21 9.21 0 00-.983-.31 11.68 11.68 0 00-1.047-.237c.129.07.254.147.375.228.238.158.461.335.664.531a5.97 5.97 0 00-.977-.252 8.107 8.107 0 00-2.085-.089c-.355.032-.707.09-1.054.173-.346.082-.686.19-1.016.322a7.562 7.562 0 00-.961.448 7.145 7.145 0 00-.888.556c.193-.045.386-.082.579-.109.386-.056.772-.073 1.15-.052a6.7 6.7 0 00-.919.34 6.185 6.185 0 00-1.609 1.022 5.397 5.397 0 00-1.16 1.473 5.378 5.378 0 00-.525 1.33 5.59 5.59 0 00-.148 1.39c.007.235.028.472.062.71.021.147.047.294.08.441a4.753 4.753 0 01-.45-.648 4.904 4.904 0 01-.486-1.122 5.342 5.342 0 01-.185-1.26 6.238 6.238 0 01.121-1.32 7.58 7.58 0 01.385-1.292 9.164 9.164 0 01.588-1.203c.22-.38.47-.744.744-1.088.275-.344.575-.665.9-.963a9.52 9.52 0 011.008-.793 10.583 10.583 0 011.095-.65c-.276-.02-.549-.027-.818-.022zM6.75 7.456c.017.004.034.01.05.019.035.019.064.044.087.074a.27.27 0 01.054.108c.012.04.017.084.014.13a.546.546 0 01-.036.157.913.913 0 01-.1.192 1.67 1.67 0 01-.352.379c.11.052.207.12.287.203a.69.69 0 01.164.287.71.71 0 01.023.32.863.863 0 01-.118.327 1.26 1.26 0 01-.245.283c-.1.087-.215.162-.346.223a2.04 2.04 0 01-.438.138 2.564 2.564 0 01-.522.038l-.027-.93a1.52 1.52 0 00.447-.045.522.522 0 00.219-.125.335.335 0 00.088-.168.317.317 0 00-.003-.167.216.216 0 00-.082-.117.365.365 0 00-.146-.06 1.081 1.081 0 00-.195-.016h-.188l-.027-.815h.219c.086.002.166-.01.237-.034a.435.435 0 00.163-.09.274.274 0 00.08-.127.285.285 0 00.002-.143.198.198 0 00-.055-.103.242.242 0 00-.105-.058.614.614 0 00-.15-.019h-.219l.08-1.01h.95l-.023.79h-.338c.065.035.12.078.163.127.043.05.075.103.095.16a.42.42 0 01.023.133zm9.066-.1c-.06.202-.15.394-.27.573a2.332 2.332 0 01-.431.463 2.196 2.196 0 01-.553.327 2.04 2.04 0 01-.327.107 1.32 1.32 0 00.127.166c.055.06.117.111.186.152.07.042.147.073.232.094s.177.032.274.032c.102 0 .208-.01.315-.032a1.59 1.59 0 00.315-.1 1.733 1.733 0 00.299-.165c.097-.067.186-.144.27-.231l.598.748a2.91 2.91 0 01-.509.389 2.985 2.985 0 01-.591.275 3.143 3.143 0 01-1.305.132 2.27 2.27 0 01-.6-.145 1.84 1.84 0 01-.49-.298 1.787 1.787 0 01-.353-.412 1.988 1.988 0 01-.221-.517 3.17 3.17 0 01-.088-.591 5.333 5.333 0 01.02-.655c.02-.224.058-.444.113-.66a3.36 3.36 0 01.21-.616c.088-.197.194-.38.32-.55.123-.168.268-.316.432-.445a2.024 2.024 0 01.551-.304 1.959 1.959 0 01.676-.113c.205 0 .4.034.582.1.183.068.348.168.494.302a1.51 1.51 0 01.352.495c.087.198.136.425.147.68.005.12 0 .26-.014.42a3.36 3.36 0 01-.07.411zm-1.215-.35a.89.89 0 00.038-.155.96.96 0 00.006-.161.504.504 0 00-.031-.166.352.352 0 00-.084-.127.374.374 0 00-.137-.083.52.52 0 00-.191-.03.574.574 0 00-.265.066.874.874 0 00-.234.182 1.26 1.26 0 00-.186.264 1.606 1.606 0 00-.122.313zM7.98 12.698a1.57 1.57 0 01-.154.5 1.554 1.554 0 01-.298.404 1.439 1.439 0 01-.413.276 1.367 1.367 0 01-.498.104 1.262 1.262 0 01-.483-.079 1.193 1.193 0 01-.385-.236 1.42 1.42 0 01-.28-.361 2.19 2.19 0 01-.169-.452l.878-.296c.03.103.071.19.126.262a.387.387 0 00.312.163.332.332 0 00.16-.04.425.425 0 00.123-.106.506.506 0 00.079-.155.603.603 0 00.027-.182.592.592 0 00-.055-.267.575.575 0 00-.152-.192.74.74 0 00-.218-.128 1.54 1.54 0 00-.25-.078l.176-.82c.163.04.305.097.424.171.12.074.218.16.296.26.077.099.135.207.174.325a1.195 1.195 0 01.06.427zm5.254-1.286a.96.96 0 01-.018.144 1.45 1.45 0 01-.176.466 1.57 1.57 0 01-.318.382 1.597 1.597 0 01-.422.263 1.465 1.465 0 01-.488.104 1.307 1.307 0 01-.49-.072 1.223 1.223 0 01-.396-.225 1.325 1.325 0 01-.282-.346 1.782 1.782 0 01-.168-.437l.878-.297c.03.098.071.181.125.25a.393.393 0 00.306.16.32.32 0 00.156-.04.428.428 0 00.121-.103.512.512 0 00.08-.149.573.573 0 00.028-.176.584.584 0 00-.053-.26.555.555 0 00-.148-.189.723.723 0 00-.213-.127 1.502 1.502 0 00-.245-.078l.172-.82c.163.04.306.096.427.168.12.071.222.156.303.254a1.08 1.08 0 01.25.71c0 .059-.004.116-.01.168z"/>
    </svg>
  )
}

// Riot Games Logo
export function RiotIcon({ className }: { className?: string }) {
  return (
    <svg className={className} viewBox="0 0 24 24" fill="currentColor">
      <path d="M12.534 21.77l-1.09-2.81 10.52.54-.451 4.5zM15.06 0L.307 6.969 2.59 17.471H5.6l-.52-7.512 2.608-.963-.104 8.475h3.073l.104-9.604 2.608-.964-.207 10.568h3.01l.622-15.063L15.06 0zm-8.93 20.44l-2.71.135.099.985 2.423 1.32z"/>
    </svg>
  )
}

type StoreLink = {
  platform: string
  url: string
  label: string
  color: string
  icon: React.ComponentType<{ className?: string }>
}

export function getStoreLinks(
  gameName: string,
  platforms: string[] = [],
  steamAppId?: string | number | null
): StoreLink[] {
  const encodedName = encodeURIComponent(gameName)
  const platformLower = platforms.map(p => p.toLowerCase()).join(' ')
  const links: StoreLink[] = []

  if (platformLower.includes('pc') || platformLower.includes('steam') || platformLower.includes('windows') || platforms.length === 0) {
    links.push({
      platform: 'steam',
      url: steamAppId
        ? `https://store.steampowered.com/app/${steamAppId}`
        : `https://store.steampowered.com/search/?term=${encodedName}`,
      label: 'Steam',
      color: 'bg-[#1b2838] hover:bg-[#2a475e]',
      icon: SteamIcon,
    })
  }

  if (platformLower.includes('ps') || platformLower.includes('playstation')) {
    links.push({
      platform: 'playstation',
      url: `https://store.playstation.com/search/${encodedName}`,
      label: 'PlayStation',
      color: 'bg-[#003791] hover:bg-[#0050b3]',
      icon: PlayStationIcon,
    })
  }

  if (platformLower.includes('xbox')) {
    links.push({
      platform: 'xbox',
      url: `https://www.xbox.com/search?q=${encodedName}`,
      label: 'Xbox',
      color: 'bg-[#107c10] hover:bg-[#0e6b0e]',
      icon: XboxIcon,
    })
  }

  if (platformLower.includes('switch') || platformLower.includes('nintendo')) {
    links.push({
      platform: 'nintendo',
      url: `https://www.nintendo.com/search/#q=${encodedName}`,
      label: 'Nintendo',
      color: 'bg-[#e60012] hover:bg-[#c9000f]',
      icon: NintendoIcon,
    })
  }

  // Default to Steam if no platforms
  if (links.length === 0) {
    links.push({
      platform: 'steam',
      url: `https://store.steampowered.com/search/?term=${encodedName}`,
      label: 'Steam',
      color: 'bg-[#1b2838] hover:bg-[#2a475e]',
      icon: SteamIcon,
    })
  }

  return links
}

type StoreLinkButtonsProps = {
  gameName: string
  platforms?: string[]
  steamAppId?: string | number | null
  showLabel?: boolean
  size?: 'sm' | 'md'
}

export function StoreLinkButtons({
  gameName,
  platforms = [],
  steamAppId,
  showLabel = false,
  size = 'md',
}: StoreLinkButtonsProps) {
  const links = getStoreLinks(gameName, platforms, steamAppId)

  const sizeClasses = size === 'sm'
    ? 'p-2'
    : showLabel ? 'px-4 py-2' : 'p-2.5'

  const iconSize = size === 'sm' ? 'h-4 w-4' : 'h-5 w-5'

  return (
    <div className="flex flex-wrap gap-2">
      {links.map((link) => {
        const Icon = link.icon
        return (
          <a
            key={link.platform}
            href={link.url}
            target="_blank"
            rel="noopener noreferrer"
            className={`inline-flex items-center gap-2 rounded-lg text-white text-sm font-medium transition-colors ${link.color} ${sizeClasses}`}
            title={link.label}
          >
            <Icon className={iconSize} />
            {showLabel && <span>{link.label}</span>}
            {showLabel && <ExternalLink className="h-3.5 w-3.5" />}
          </a>
        )
      })}
    </div>
  )
}
